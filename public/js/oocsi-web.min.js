var OOCSI=function(){function g(){f("CONNECTING to "+a),d=new WebSocket(a),d.onopen=function(a){h(a)},d.onclose=function(a){i(a)},d.onmessage=function(a){j(a)},d.onerror=function(a){k(a)}}function h(a){d.readyState==WebSocket.OPEN&&(n(b),e=!0),f("CONNECTED")}function i(a){f("DISCONNECTED")}function j(a){if(d.send("."),"ping"!=a.data){try{var b=JSON.parse(a.data);void 0!==c[b.recipient]?c[b.recipient](b):f("no handler for event: "+a.data)}catch(b){f("parse exception for event: "+a.data)}f("RESPONSE: "+a.data)}}function k(a){f("ERROR: "+a.data)}function l(a){d&&d.readyState!=WebSocket.CONNECTING?a():setTimeout(function(){l(a)},200)}function m(){d&&d.close()}function n(a){if(d)try{d.send(a),f("SENT: "+a)}catch(a){f("wasn't able to send message: ",a.message,a.name)}}function o(a){}function p(a,b){e&&n("sendjson "+a+" "+JSON.stringify("string"==typeof b?{message:b}:b))}function q(a,b){e&&(n("subscribe "+a),c[a]=b)}function r(a){e&&(n("unsubscribe "+a),c[a]=function(){})}var b,d,a="ws://localhost:9000/",c={},e=!1,f=o;return{connect:function(d,e,f){a=d,b=e&&e.length>0?e:"webclient_"+ +new Date,c[e]=f,g()},send:function(a,b){p(a,b)},subscribe:function(a,b){l(function(){q(a,b)})},unsubscribe:function(a){l(function(){r(a)})},close:function(){l(function(){m()})},handlers:function(){return c},logger:function(a){f=a}}}();
